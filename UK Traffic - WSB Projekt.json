{"paragraphs":[{"text":"%md\n## Stan tabel przed operacjami:","user":"anonymous","dateUpdated":"2021-01-11T21:26:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Stan tabel przed operacjami:</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1610400292071_772286832","id":"20210111-212452_1430873165","dateCreated":"2021-01-11T21:24:52+0000","dateStarted":"2021-01-11T21:26:10+0000","dateFinished":"2021-01-11T21:26:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2354"},{"text":"spark.sql(\"show tables\").show() ","user":"anonymous","dateUpdated":"2021-01-11T21:24:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-------------+-----------+\n|database|    tableName|isTemporary|\n+--------+-------------+-----------+\n| default|      f_fakty|      false|\n| default|       w_czas|      false|\n| default|      w_drogi|      false|\n| default|  w_geografia|      false|\n| default|     w_pogoda|      false|\n| default|w_typ_pojazdu|      false|\n+--------+-------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1610399590782_540682061","id":"20210111-211310_1807512233","dateCreated":"2021-01-11T21:13:10+0000","dateStarted":"2021-01-11T21:24:47+0000","dateFinished":"2021-01-11T21:24:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2355"},{"text":"%md\n## Operacja tworzenia tabel dla hurtowni:","user":"anonymous","dateUpdated":"2021-01-11T21:26:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Operacja tworzenia tabel dla hurtowni:</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1610400324604_-486939777","id":"20210111-212524_1418634508","dateCreated":"2021-01-11T21:25:24+0000","dateStarted":"2021-01-11T21:26:09+0000","dateFinished":"2021-01-11T21:26:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2356"},{"text":"spark.sql(\"\"\"CREATE TABLE IF NOT EXISTS `w_czas` ( \r\n    `data` timestamp, \r\n    `dzien` int,\r\n    `miesiac` int, \r\n    `rok` int,\r\n    `godzina` int) \r\nROW FORMAT SERDE \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcSerde'\r\nSTORED AS INPUTFORMAT\r\n    'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'\r\n OUTPUTFORMAT \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\"\"\")\r\n\r\nspark.sql(\"\"\"CREATE TABLE IF NOT EXISTS `w_pogoda` ( \r\n    `id_pogody` int, \r\n    `warunki_pogodowe` string) \r\nROW FORMAT SERDE \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcSerde'\r\nSTORED AS INPUTFORMAT\r\n    'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'\r\n OUTPUTFORMAT \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\"\"\")\r\n\r\nspark.sql(\"\"\"CREATE TABLE IF NOT EXISTS `w_geografia` ( \r\n    `id_jednostki_adm` string, \r\n    `nazwa` string,\r\n    `kod_regionu` string,\r\n    `nazwa_regionu` string) \r\nROW FORMAT SERDE \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcSerde'\r\nSTORED AS INPUTFORMAT\r\n    'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'\r\n OUTPUTFORMAT \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\"\"\")\r\n\r\nspark.sql(\"\"\"CREATE TABLE IF NOT EXISTS `w_drogi` ( \r\n    `id_drogi` int, \r\n    `typ_drogi` string,\r\n    `kategoria_drogi` string) \r\nROW FORMAT SERDE \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcSerde'\r\nSTORED AS INPUTFORMAT\r\n    'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'\r\n OUTPUTFORMAT \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\"\"\")\r\n\r\nspark.sql(\"\"\"CREATE TABLE IF NOT EXISTS `w_typ_pojazdu` ( \r\n    `id_typu_pojazdu` int, \r\n    `typ_pojazdu` string,\r\n    `kategoria_pojazdu` string,\r\n    `czy_silnik` boolean) \r\nROW FORMAT SERDE \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcSerde'\r\nSTORED AS INPUTFORMAT\r\n    'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'\r\n OUTPUTFORMAT \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\"\"\")\r\n\r\nspark.sql(\"\"\" CREATE TABLE IF NOT EXISTS `f_fakty` (\r\n    `data` date,\r\n    `id_pogody` int,\r\n    `id_jednostki_adm` string,\r\n    `id_drogi` int,\r\n    `id_typu_pojazdu` int,\r\n    `liczba_pojazdow` int)\r\nROW FORMAT SERDE \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcSerde'\r\nSTORED AS INPUTFORMAT\r\n    'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'\r\n OUTPUTFORMAT \r\n    'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'\"\"\")\r\n    \r\n","user":"anonymous","dateUpdated":"2021-01-11T21:24:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res12: org.apache.spark.sql.DataFrame = []\n"}]},"apps":[],"jobName":"paragraph_1610399600388_1027239584","id":"20210111-211320_1841848512","dateCreated":"2021-01-11T21:13:20+0000","dateStarted":"2021-01-11T21:24:43+0000","dateFinished":"2021-01-11T21:24:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2357"},{"text":"%md\n## Czyszczenie tabel hurtowni: ","user":"anonymous","dateUpdated":"2021-01-11T21:26:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Czyszczenie tabel hurtowni:</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1610400350450_1069602106","id":"20210111-212550_1060253180","dateCreated":"2021-01-11T21:25:50+0000","dateStarted":"2021-01-11T21:26:04+0000","dateFinished":"2021-01-11T21:26:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2358"},{"text":"spark.sql(\"DROP TABLE IF EXISTS w_czas\")\r\nspark.sql(\"DROP TABLE IF EXISTS w_pogoda\")\r\nspark.sql(\"DROP TABLE IF EXISTS w_geografia\")\r\nspark.sql(\"DROP TABLE IF EXISTS w_drogi\")\r\nspark.sql(\"DROP TABLE IF EXISTS w_typ_pojazdu\")\r\nspark.sql(\"DROP TABLE IF EXISTS f_fakty\")","user":"anonymous","dateUpdated":"2021-01-11T21:24:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res10: org.apache.spark.sql.DataFrame = []\n"}]},"apps":[],"jobName":"paragraph_1610399755102_-134005682","id":"20210111-211555_1455471256","dateCreated":"2021-01-11T21:15:55+0000","dateStarted":"2021-01-11T21:24:04+0000","dateFinished":"2021-01-11T21:24:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2359"},{"text":"import org.apache.spark.sql._\r\n\r\n// change username\r\nval username = \"username\"\r\n\r\nval scotlandAuthorities = spark.read.\r\n format(\"org.apache.spark.csv\").\r\n option(\"header\", true).\r\n option(\"inferSchema\", true).\r\n csv(s\"/user/$username/proj/spark/authoritiesScotland.csv\").cache()\r\n\r\nval scotlandRegions = spark.read.\r\n format(\"org.apache.spark.csv\").\r\n option(\"header\", true).\r\n option(\"inferSchema\", true).\r\n csv(s\"/user/$username/proj/spark/regionsScotland.csv\").cache()","user":"anonymous","dateUpdated":"2021-01-11T22:16:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql._\nusername: String = username\nscotlandAuthorities: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [local_authority_ons_code: string, local_authority_id: int ... 2 more fields]\nscotlandRegions: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [region_id: int, region_name: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=9","http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=10","http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=11","http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=12"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1610400244874_1553957345","id":"20210111-212404_1201933956","dateCreated":"2021-01-11T21:24:04+0000","dateStarted":"2021-01-11T22:10:35+0000","dateFinished":"2021-01-11T22:10:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2360"},{"text":"scotlandAuthorities.select($\"region_id\").show()","user":"anonymous","dateUpdated":"2021-01-11T22:05:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+\n|region_id|\n+---------+\n|        3|\n+---------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1610402422463_981051559","id":"20210111-220022_1517739688","dateCreated":"2021-01-11T22:00:22+0000","dateStarted":"2021-01-11T22:05:41+0000","dateFinished":"2021-01-11T22:05:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2361"},{"text":"scotlandAuthorities.join(scotlandRegions, \n    scotlandAuthorities(\"region_ons_code\") === scotlandRegions(\"region_ons_code\")).\n    select(\n        scotlandAuthorities(\"local_authority_ons_code\"),\n        scotlandAuthorities(\"local_authority_name\"),\n        scotlandRegions(\"region_ons_code\"),\n        scotlandRegions(\"region_name\")).write.insertInto(\"w_geografia\")","user":"anonymous","dateUpdated":"2021-01-11T22:11:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=15","http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=16"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1610402741554_112653940","id":"20210111-220541_679372584","dateCreated":"2021-01-11T22:05:41+0000","dateStarted":"2021-01-11T22:11:13+0000","dateFinished":"2021-01-11T22:11:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2362"},{"text":"val geografia = spark.sql(\"SELECT id_jednostki_adm, nazwa FROM w_geografia\")\n\ngeografia.show()","user":"anonymous","dateUpdated":"2021-01-11T22:12:53+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------+--------------------+\n|id_jednostki_adm|               nazwa|\n+----------------+--------------------+\n|       S12000021|      North Ayrshire|\n|       S12000010|        East Lothian|\n|       S12000019|          Midlothian|\n|       S12000030|            Stirling|\n|       S12000005|    Clackmannanshire|\n|       S12000048|     Perth & Kinross|\n|       S12000042|         Dundee City|\n|       S12000047|                Fife|\n|       S12000040|        West Lothian|\n|       S12000038|        Renfrewshire|\n|       S12000008|       East Ayrshire|\n|       S12000028|      South Ayrshire|\n|       S12000017|            Highland|\n|       S12000014|             Falkirk|\n|       S12000023|      Orkney Islands|\n|       S12000029|   South Lanarkshire|\n|       S12000013|Comhairle nan Eil...|\n|       S12000035|       Argyll & Bute|\n|       S12000006| Dumfries & Galloway|\n|       S12000045| East Dunbartonshire|\n+----------------+--------------------+\nonly showing top 20 rows\n\ngeografia: org.apache.spark.sql.DataFrame = [id_jednostki_adm: string, nazwa: string]\n"}]},"apps":[],"jobName":"paragraph_1610402864567_-1750911331","id":"20210111-220744_1557297192","dateCreated":"2021-01-11T22:07:44+0000","dateStarted":"2021-01-11T22:12:53+0000","dateFinished":"2021-01-11T22:12:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2363","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://big-data-processing-wsb-cluster-1-m.europe-west3-c.c.big-data-processing-wsb.internal:4040/jobs/job?id=17"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1610403127488_651624055","id":"20210111-221207_1444628048","dateCreated":"2021-01-11T22:12:07+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2364"}],"name":"UK Traffic - WSB Projekt","id":"2FTYBX8SU","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}